<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YOU HAVE BEEN CHOSEN</title>
    <style>
        :root {
            --neon-blue: #00f2ff;
            --blood-red: #ff4757;
        }
        body { margin: 0; background: #000; color: white; font-family: 'Courier New', Courier, monospace; overflow: hidden; touch-action: none; }
        canvas { display: block; width: 100vw; height: 100vh; }

        #game-title {
            position: absolute; top: 5%; width: 100%; text-align: center;
            font-size: 1.2rem; letter-spacing: 3px; color: var(--neon-blue);
            text-shadow: 0 0 8px var(--neon-blue); pointer-events: none;
            text-transform: uppercase; animation: flicker 3s infinite;
            z-index: 5;
        }

        #ui { position: absolute; top: 12%; width: 100%; text-align: center; pointer-events: none; z-index: 5; }
        #score { font-size: 50px; font-weight: bold; opacity: 0.8; color: white; }

        #overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95); display: none;
            flex-direction: column; justify-content: center; align-items: center;
            padding: 20px; box-sizing: border-box; z-index: 20; text-align: center;
        }

        .invite-text { 
            color: var(--blood-red); font-size: 1.1rem; margin-bottom: 20px;
            line-height: 1.6; max-width: 400px;
        }

        .glitch { font-weight: bold; text-transform: uppercase; font-size: 1.3rem; display: block; margin-top: 10px; color: white; }

        .btn-group { display: flex; flex-direction: column; gap: 12px; width: 80%; max-width: 300px; }
        button { 
            background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue);
            padding: 15px; cursor: pointer; font-family: inherit; font-weight: bold; text-transform: uppercase;
        }
        button:active { background: var(--neon-blue); color: black; }

        #copy-btn { border-color: #777; color: #bbb; font-size: 0.7rem; border-style: dashed; }

        #jumpscare {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: black; z-index: 100; display: none;
        }
        #jumpscare img { width: 100%; height: 100%; object-fit: cover; }

        @keyframes flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% { opacity: 1; }
            20%, 24%, 55% { opacity: 0.3; }
        }

        /* Screen Shake Animation */
        @keyframes shake {
            0% { transform: translate(1px, 1px); }
            20% { transform: translate(-3px, 0px); }
            40% { transform: translate(3px, 2px); }
            60% { transform: translate(-3px, 1px); }
            80% { transform: translate(-1px, -1px); }
            100% { transform: translate(1px, -2px); }
        }
        .shaking { animation: shake 0.1s infinite; }
    </style>
</head>
<body>

    <div id="game-title">YOU HAVE BEEN CHOSEN</div>
    
    <div id="ui">
        <div id="score">0</div>
    </div>

    <div id="overlay">
        <div class="invite-text">
            YOUR SOUL HAS FALLEN...<br>
            <span class="glitch">VISIT OUR ESCAPE ROOM AT JRN 104</span><br>
            FEB 11-14 | 8 AM
        </div>
        <div class="btn-group">
            <button onclick="resetGame()">TRY TO ESCAPE AGAIN</button>
            <button id="copy-btn" onclick="copyLink()">CURSE A FRIEND (COPY LINK)</button>
        </div>
    </div>

    <div id="jumpscare">
        <img id="scare-img" src="">
        <audio id="scream-snd"></audio>
    </div>

    <canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const overlay = document.getElementById('overlay');

    // --- CONFIGURE ASSETS HERE ---
    const IMAGES = ["https://via.placeholder.com/800x1200/000000/ff0000?text=I+SEE+YOU"]; 
    const SOUNDS = ["https://www.soundjay.com/human/sounds/scream-01.mp3"];

    let width, height, dpr;
    let score = 0, gameActive = true;
    
    // Updated Physics for Floatier Movement
    const gravity = 0.15;    
    const jumpPower = -6;   
    const pipeWidth = 70;
    const pipeGap = 190;
    const pipeSpeed = 2.2;

    let bird = { x: 50, y: 0, velocity: 0, radius: 10 };
    let pipes = [];
    let frameCount = 0;

    function resize() {
        dpr = window.devicePixelRatio || 1;
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width * dpr;
        canvas.height = height * dpr;
        ctx.scale(dpr, dpr);
        bird.y = height / 2;
        bird.x = width * 0.2;
    }

    function spawnPipe() {
        const minPipeHeight = 80;
        const totalPipeSpace = height - pipeGap;
        const topPipeHeight = Math.random() * (totalPipeSpace - minPipeHeight * 2) + minPipeHeight;
        pipes.push({ x: width, topHeight: topPipeHeight, passed: false });
    }

    function gameOver() {
        if (!gameActive) return;
        gameActive = false;
        
        // 30% chance of jumpscare
        if (Math.random() < 0.3) triggerScare();
        else showOverlay();
    }

    function triggerScare() {
        const js = document.getElementById('jumpscare');
        const img = document.getElementById('scare-img');
        const snd = document.getElementById('scream-snd');
        
        img.src = IMAGES[Math.floor(Math.random() * IMAGES.length)];
        snd.src = SOUNDS[Math.floor(Math.random() * SOUNDS.length)];
        
        js.style.display = 'block';
        js.classList.add('shaking');
        snd.play().catch(() => {});
        
        setTimeout(() => { 
            js.style.display = 'none'; 
            js.classList.remove('shaking');
            showOverlay(); 
        }, 1200);
    }

    function showOverlay() { overlay.style.display = 'flex'; }

    function resetGame() {
        score = 0; pipes = []; bird.y = height / 2; bird.velocity = 0;
        scoreEl.innerText = "0";
        gameActive = true; overlay.style.display = 'none';
    }

    function copyLink() {
        const el = document.createElement('textarea');
        el.value = window.location.href;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        
        const btn = document.getElementById('copy-btn');
        btn.innerText = "LINK COPIED!";
        setTimeout(() => btn.innerText = "CURSE A FRIEND (COPY LINK)", 2000);
    }

    function update() {
        if (!gameActive) return;

        bird.velocity += gravity;
        bird.y += bird.velocity;

        if (bird.y + bird.radius > height || bird.y - bird.radius < 0) gameOver();

        if (frameCount % 110 === 0) spawnPipe();
        
        pipes.forEach((p, i) => {
            p.x -= pipeSpeed;
            if (bird.x + bird.radius > p.x && bird.x - bird.radius < p.x + pipeWidth) {
                if (bird.y - bird.radius < p.topHeight || bird.y + bird.radius > p.topHeight + pipeGap) {
                    gameOver();
                }
            }
            if (!p.passed && p.x + pipeWidth < bird.x) {
                p.passed = true;
                score++;
                scoreEl.innerText = score;
            }
        });

        pipes = pipes.filter(p => p.x + pipeWidth > 0);
        frameCount++;
    }

    function draw() {
        ctx.fillStyle = '#050505';
        ctx.fillRect(0, 0, width, height);

        pipes.forEach(p => {
            ctx.fillStyle = '#111';
            ctx.strokeStyle = '#ff4757';
            ctx.lineWidth = 4;
            // Top pipe
            ctx.fillRect(p.x, 0, pipeWidth, p.topHeight);
            ctx.strokeRect(p.x, -5, pipeWidth, p.topHeight + 5);
            // Bottom pipe
            ctx.fillRect(p.x, p.topHeight + pipeGap, pipeWidth, height - p.topHeight - pipeGap);
            ctx.strokeRect(p.x, p.topHeight + pipeGap, pipeWidth, height - p.topHeight - pipeGap + 5);
        });

        ctx.fillStyle = '#00f2ff';
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#00f2ff';
        ctx.beginPath();
        ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
    }

    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }

    const jump = () => { if(gameActive) bird.velocity = jumpPower; };
    window.addEventListener('mousedown', jump);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); jump(); }, {passive: false});
    window.addEventListener('resize', resize);

    resize();
    loop();
</script>
</body>
</html>
