<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Orbit Jump</title>
    <style>
        body { margin: 0; background: #0a0a0a; color: white; font-family: sans-serif; overflow: hidden; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 20px; width: 100%; text-align: center; pointer-events: none; }
        #score { font-size: 48px; font-weight: bold; opacity: 0.8; }
        #msg { font-size: 18px; color: #aaa; }
    </style>
</head>
<body>
    <div id="ui">
        <div id="score">0</div>
        <div id="msg">Tap to Jump Orbit</div>
    </div>
    <canvas id="game"></canvas>

<script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');

    let width, height, centerX, centerY;
    let score = 0;
    let gameActive = true;
    
    // Game constants
    const orbits = [60, 110, 160]; // Radii of the three orbits
    let player = { orbitIdx: 0, angle: 0, speed: 0.05, size: 8 };
    let obstacles = [];
    let lastObstacleTime = 0;

    function init() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
        centerX = width / 2;
        centerY = height / 2;
    }

    function spawnObstacle() {
        const orbitIdx = Math.floor(Math.random() * orbits.length);
        const speed = (0.02 + Math.random() * 0.03) * (Math.random() > 0.5 ? 1 : -1);
        obstacles.push({
            orbitIdx,
            angle: Math.random() * Math.PI * 2,
            speed,
            width: 0.4 // Arc width in radians
        });
    }

    function update() {
        if (!gameActive) return;

        // Move player
        player.angle += player.speed;

        // Move obstacles
        obstacles.forEach(obs => obs.angle += obs.speed);

        // Difficulty: spawn faster over time
        if (Date.now() - lastObstacleTime > 1500 - Math.min(score * 20, 1000)) {
            spawnObstacle();
            lastObstacleTime = Date.now();
        }

        // Collision Detection
        obstacles.forEach(obs => {
            if (obs.orbitIdx === player.orbitIdx) {
                let diff = Math.abs(player.angle % (Math.PI * 2) - obs.angle % (Math.PI * 2));
                if (diff < obs.width || diff > (Math.PI * 2 - obs.width)) {
                    gameOver();
                }
            }
        });

        // Cleanup off-screen/old obstacles
        if (obstacles.length > 10) obstacles.shift();
        
        score += 0.01; // Tiny score increment for survival
        scoreEl.innerText = Math.floor(score);
    }

    function draw() {
        ctx.fillStyle = '#0a0a0a';
        ctx.fillRect(0, 0, width, height);

        // Draw Orbits
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        orbits.forEach(r => {
            ctx.beginPath();
            ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
            ctx.stroke();
        });

        // Draw Obstacles
        obstacles.forEach(obs => {
            ctx.strokeStyle = '#ff4757';
            ctx.lineWidth = 10;
            ctx.beginPath();
            ctx.arc(centerX, centerY, orbits[obs.orbitIdx], obs.angle, obs.angle + obs.width);
            ctx.stroke();
        });

        // Draw Player
        const px = centerX + Math.cos(player.angle) * orbits[player.orbitIdx];
        const py = centerY + Math.sin(player.angle) * orbits[player.orbitIdx];
        
        ctx.fillStyle = '#1e90ff';
        ctx.shadowBlur = 15;
        ctx.shadowColor = '#1e90ff';
        ctx.beginPath();
        ctx.arc(px, py, player.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0; // Reset shadow
    }

    function gameOver() {
        gameActive = false;
        document.getElementById('msg').innerText = "GAME OVER - Tap to Restart";
    }

    function reset() {
        score = 0;
        player.orbitIdx = 0;
        obstacles = [];
        gameActive = true;
        document.getElementById('msg').innerText = "Tap to Jump Orbit";
    }

    function loop() {
        update();
        draw();
        requestAnimationFrame(loop);
    }

    // Controls
    window.addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (!gameActive) {
            reset();
        } else {
            player.orbitIdx = (player.orbitIdx + 1) % orbits.length;
            score += 5; // Bonus for jumping
        }
    });

    // Support desktop clicking too
    window.addEventListener('mousedown', () => {
        if (!gameActive) reset();
        else player.orbitIdx = (player.orbitIdx + 1) % orbits.length;
    });

    window.addEventListener('resize', init);

    init();
    loop();
</script>
</body>
</html>
